<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>åå°ç®¡ç†</title>
  <style>
    :root {
      --bg: #f8fafc;
      --card-bg: #ffffff;
      --primary: #3b82f6;
      --primary-hover: #2563eb;
      --text: #1e293b;
      --text-muted: #64748b;
      --border: #e2e8f0;
      --shadow: 0 2px 8px rgba(0,0,0,0.06);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    }

    body {
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
      padding: 20px;
    }

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 0;
      margin-bottom: 24px;
    }

    .header h1 {
      font-size: 24px;
      font-weight: 700;
      color: var(--primary);
    }

    .back-btn {
      background: var(--primary);
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 12px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      transition: background 0.2s;
    }

    .back-btn:hover {
      background: var(--primary-hover);
    }

    .section {
      background: var(--card-bg);
      padding: 20px;
      border-radius: 16px;
      margin-bottom: 24px;
      box-shadow: var(--shadow);
      border: 1px solid var(--border);
    }

    .section h2 {
      margin-bottom: 16px;
      font-size: 18px;
      font-weight: 600;
      color: var(--primary);
    }

    /* å…¬å‘Šç¼–è¾‘ - å®æ—¶é¢„è§ˆ */
    .announcement-preview {
      margin-top: 8px;
      padding: 8px;
      background: #f1f5f9;
      border-radius: 8px;
      font-size: 14px;
      color: var(--text-muted);
    }

    /* å“ç±»ç®¡ç† */
    .category-list {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-bottom: 16px;
    }

    .category-item {
      background: #f1f5f9;
      padding: 8px 16px;
      border-radius: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
      min-width: 120px;
    }

    .category-name {
      cursor: pointer;
      flex: 1;
      text-align: left;
      color: var(--text);
      font-weight: 500;
    }

    .category-name:hover {
      color: var(--primary);
      text-decoration: underline;
    }

    .category-item button {
      background: #ef4444;
      color: white;
      border: none;
      padding: 4px 10px;
      border-radius: 8px;
      font-size: 12px;
      cursor: pointer;
      font-weight: 600;
    }

    .toggle-visibility {
      background: #cbd5e1;
      color: var(--text);
      border: none;
      padding: 4px 8px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 12px;
    }

    .toggle-visibility.hidden {
      background: #f87171;
    }

    .add-category-form {
      display: flex;
      gap: 12px;
      margin-bottom: 16px;
    }

    .add-category-form input {
      flex: 1;
      padding: 10px 14px;
      border: 1px solid var(--border);
      border-radius: 12px;
      background: white;
      color: var(--text);
      font-size: 15px;
    }

    .add-category-form button {
      background: var(--primary);
      color: white;
      border: none;
      padding: 10px 16px;
      border-radius: 12px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      transition: background 0.2s;
    }

    .add-category-form button:hover {
      background: var(--primary-hover);
    }

    /* æ¸¸æˆè¡¨æ ¼ */
    .platform-group {
      margin-bottom: 32px;
    }

    .platform-title {
      font-weight: 700;
      margin-bottom: 16px;
      color: var(--primary);
      font-size: 16px;
    }

    .game-table {
      width: 100%;
      border-collapse: collapse;
      table-layout: fixed;
    }

    .game-table colgroup col:nth-child(1) { width: 8%; }  /* ID */
    .game-table colgroup col:nth-child(2) { width: 8%; }  /* å°é¢ */
    .game-table colgroup col:nth-child(3) { width: 15%; } /* åç§° */
    .game-table colgroup col:nth-child(4) { width: 12%; } /* å¹³å° */
    .game-table colgroup col:nth-child(5) { width: 12%; } /* æ ‡ç­¾ */
    .game-table colgroup col:nth-child(6) { width: 8%; }  /* è§’æ ‡ */
    .game-table colgroup col:nth-child(7) { width: 8%; }  /* ä»‹ç» */
    .game-table colgroup col:nth-child(8) { width: 10%; } /* é“¾æ¥ */
    .game-table colgroup col:nth-child(9) { width: 10%; } /* æ’åº */
    .game-table colgroup col:nth-child(10) { width: 9%; }/* æ“ä½œ */

    .game-table th,
    .game-table td {
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid var(--border);
      color: var(--text);
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .game-table th {
      background: #f1f5f9;
      color: var(--text-muted);
      font-weight: 600;
    }

    .game-table img {
      width: 40px;
      height: 40px;
      object-fit: cover;
      border-radius: 8px;
    }

    .tag-cell, .url-cell, .desc-cell {
      max-width: 120px;
      word-break: break-all;
      white-space: normal;
    }

    .edit-btn, .delete-btn {
      padding: 6px 12px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 12px;
      font-weight: 600;
      margin-right: 6px;
    }

    .edit-btn {
      background: var(--primary);
      color: white;
    }

    .delete-btn {
      background: #ef4444;
      color: white;
    }

    .draggable-row {
      cursor: move;
    }

    /* ç¼–è¾‘/æ–°å¢è¡¨å•å®¹å™¨ - ç»Ÿä¸€æ¨ªå‘å¸ƒå±€ */
    .edit-form-container {
      background: #f8fafc;
      padding: 16px;
      border-radius: 12px;
      margin-top: 8px;
      border: 1px dashed var(--border);
      display: flex;
      gap: 20px;
      align-items: flex-start;
    }

    .form-left {
      flex: 1;
      min-width: 300px;
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
    }

    .form-left .form-field {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .form-left .form-field label {
      font-weight: 600;
      margin-bottom: 4px;
      color: var(--text);
      font-size: 13px;
    }

    .form-left .form-control {
      width: 100%;
      padding: 6px 10px;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: white;
      color: var(--text);
      font-size: 13px;
    }

    textarea.form-control {
      resize: vertical;
      min-height: 40px;
    }

    .form-right {
      display: flex;
      flex-direction: column;
      gap: 8px;
      justify-content: flex-start;
    }

    .form-right button {
      width: 100px;
      padding: 10px 16px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      text-align: center;
    }

    .form-right .floating-btn {
      width: auto;
      padding: 10px 16px;
      font-size: 14px;
    }

    /* æ‚¬æµ®æŒ‰é’® - ç¼©å°å¸¸é©» */
    .admin-floating-buttons {
      position: fixed;
      bottom: 20px;
      right: 20px;
      display: flex;
      flex-direction: column;
      gap: 8px;
      z-index: 999;
    }

    .floating-btn {
      background: var(--primary);
      color: white;
      border: none;
      width: 36px;
      height: 36px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 16px;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background 0.2s;
    }

    .floating-btn:hover {
      background: var(--primary-hover);
    }

    .floating-btn.copy {
      background: #10b981;
    }

    .floating-btn.export {
      background: #8b5cf6;
    }
  </style>
</head>
<body>

  <div class="header">
    <h1>åå°ç®¡ç†</h1>
    <button class="back-btn" onclick="window.location.href='index.html'">è¿”å›é¦–é¡µ</button>
  </div>

  <!-- å…¬å‘Šç®¡ç† -->
  <div class="section">
    <h2>ç³»ç»Ÿå…¬å‘Š</h2>
    <div class="form-row">
      <div class="form-col">
        <label>æ»šåŠ¨å…¬å‘Šå†…å®¹</label>
        <input type="text" class="form-control" id="announcementInput" placeholder="ä¾‹å¦‚ï¼šæ–°æ¸¸æˆä¸Šçº¿ï¼">
        <div class="announcement-preview" id="announcementPreview">
          å½“å‰å…¬å‘Šï¼š<span id="currentAnnouncement">åŠ è½½ä¸­...</span>
        </div>
      </div>
    </div>
  </div>

  <!-- å“ç±»ç®¡ç† -->
  <div class="section">
    <h2>å“ç±»ç®¡ç†ï¼ˆå¹³å°ï¼‰</h2>
    <div class="add-category-form">
      <input type="text" id="newCategoryName" placeholder="è¾“å…¥æ–°å“ç±»åç§°ï¼ˆå¦‚ï¼šç´¢å°¼ï¼‰" />
      <button onclick="addCategory()">æ·»åŠ å“ç±»</button>
    </div>
    <div class="category-list" id="categoryList">
      <!-- åŠ¨æ€ç”Ÿæˆ -->
    </div>
  </div>

  <!-- æ¸¸æˆç®¡ç† -->
  <div class="section">
    <h2>æ¸¸æˆç®¡ç†ï¼ˆå¯æ‹–æ‹½æ’åºï¼‰</h2>
    <div id="gameGroups">
      <!-- æŒ‰å¹³å°åˆ†ç»„æ¸²æŸ“ -->
    </div>
  </div>

  <!-- å³ä¸‹è§’æ‚¬æµ®æŒ‰é’®ï¼ˆç¼©å°å¸¸é©»ï¼‰ -->
  <div class="admin-floating-buttons">
    <button class="floating-btn" title="æ·»åŠ æ–°æ¸¸æˆ" onclick="showGameForm()">+</button>
    <button class="floating-btn export" title="å¯¼å‡º game.json" onclick="exportJson()">ğŸ“¤</button>
    <button class="floating-btn copy" title="å¤åˆ¶ JSON æ•°æ®" onclick="copyJsonData()">ğŸ“‹</button>
  </div>

  <script>
    let data = {
      meta: {},
      categories: [],
      games: []
    };

    async function loadData() {
      try {
        const res = await fetch('game.json');
        if (!res.ok) throw new Error('æ— æ³•åŠ è½½ game.json');
        data = await res.json();

        const announcement = data.meta?.announcement || 'æ¬¢è¿ä½¿ç”¨æ¸¸æˆå¹³å°åº“ï¼';
        document.getElementById('announcementInput').value = announcement;
        updateAnnouncementPreview(announcement);

        document.getElementById('announcementInput').addEventListener('input', (e) => {
          const text = e.target.value.trim();
          data.meta = data.meta || {};
          data.meta.announcement = text;
          updateAnnouncementPreview(text);
        });

        renderCategories();
        renderGames();
      } catch (err) {
        console.error(err);
        alert('åŠ è½½æ•°æ®å¤±è´¥ï¼Œè¯·æ£€æŸ¥ game.json æ˜¯å¦å­˜åœ¨æˆ–æ ¼å¼æ­£ç¡®ã€‚');
      }
    }

    function updateAnnouncementPreview(text) {
      document.getElementById('currentAnnouncement').textContent = text || 'ï¼ˆæ— å†…å®¹ï¼‰';
    }

    function renderCategories() {
      const list = document.getElementById('categoryList');
      list.innerHTML = '';
      data.categories.forEach(cat => {
        const isVisible = cat.visible !== false;

        const item = document.createElement('div');
        item.className = 'category-item';
        item.innerHTML = `
          <span class="category-name" onclick="editCategoryName('${cat.id}', this)">${cat.name}</span>
          <button class="toggle-visibility ${isVisible ? '' : 'hidden'}" 
                  onclick="toggleCategoryVisibility('${cat.id}')">
            ${isVisible ? 'ğŸ‘ï¸' : 'ğŸ™ˆ'}
          </button>
          <button onclick="deleteCategory('${cat.id}')">åˆ é™¤</button>
        `;
        list.appendChild(item);
      });
    }

    function toggleCategoryVisibility(id) {
      const cat = data.categories.find(c => c.id === id);
      if (cat) {
        cat.visible = cat.visible === false;
        renderCategories();
        renderGames();
      }
    }

    function editCategoryName(id, element) {
      const currentName = element.textContent;
      const newName = prompt('ç¼–è¾‘å“ç±»åç§°ï¼š', currentName);
      if (newName !== null && newName.trim() !== '' && newName !== currentName) {
        const cat = data.categories.find(c => c.id === id);
        if (cat) {
          cat.name = newName.trim();
          renderCategories();
          renderGames();
        }
      }
    }

    function addCategory() {
      const name = document.getElementById('newCategoryName').value.trim();
      if (!name) {
        alert('è¯·è¾“å…¥å“ç±»åç§°');
        return;
      }
      const newId = 'cat_' + Date.now();
      data.categories.push({ id: newId, name: name, visible: true });
      renderCategories();
      document.getElementById('newCategoryName').value = '';
    }

    function deleteCategory(id) {
      if (confirm('ç¡®å®šåˆ é™¤è¯¥å“ç±»ï¼Ÿæ‰€æœ‰å…³è”æ¸¸æˆå°†å¤±å»å“ç±»å½’å±ï¼')) {
        data.categories = data.categories.filter(c => c.id !== id);
        data.games.forEach(g => {
          if (g.category === id) g.category = '';
        });
        renderCategories();
        renderGames();
      }
    }

    function getMaxOrder() {
      if (data.games.length === 0) return 0;
      return Math.max(...data.games.map(g => g.customOrder || 0));
    }

    function renderGames() {
      const container = document.getElementById('gameGroups');
      container.innerHTML = '';

      const visibleCategoryIds = new Set();
      data.categories.forEach(cat => {
        if (cat.visible !== false) {
          visibleCategoryIds.add(cat.id);
        }
      });

      const groups = {};
      data.categories.forEach(cat => {
        if (visibleCategoryIds.has(cat.id)) {
          groups[cat.id] = { ...cat, games: [] };
        }
      });

      const visibleGames = data.games.filter(game => visibleCategoryIds.has(game.category));
      visibleGames.forEach(game => {
        const key = game.category;
        if (groups[key]) {
          groups[key].games.push(game);
        }
      });

      Object.values(groups).forEach(group => {
        group.games.sort((a, b) => (a.customOrder || 0) - (b.customOrder || 0));
      });

      Object.entries(groups).forEach(([key, group]) => {
        if (group.games.length === 0) return;

        const groupDiv = document.createElement('div');
        groupDiv.className = 'platform-group';

        const title = document.createElement('div');
        title.className = 'platform-title';
        title.textContent = `ã€${group.name}ã€‘`;
        groupDiv.appendChild(title);

        const table = document.createElement('table');
        table.className = 'game-table';

        table.innerHTML = `
          <colgroup>
            <col><col><col><col><col><col><col><col><col><col>
          </colgroup>
          <thead>
            <tr>
              <th>ID</th>
              <th>å°é¢</th>
              <th>åç§°</th>
              <th>å¹³å°</th>
              <th>æ ‡ç­¾</th>
              <th>è§’æ ‡</th>
              <th>ä»‹ç»</th>
              <th>é“¾æ¥</th>
              <th>æ’åº</th>
              <th>æ“ä½œ</th>
            </tr>
          </thead>
          <tbody id="tbody-${key}">
          </tbody>
        `;

        const tbody = table.querySelector(`#tbody-${key}`);
        group.games.forEach(game => {
          const row = document.createElement('tr');
          row.className = 'draggable-row';
          row.draggable = true;
          row.dataset.id = game.id;

          const platformName = data.categories.find(c => c.id === game.category)?.name || 'æœªåˆ†ç±»';
          const hasDesc = game.description && game.description.trim();
          const descMark = hasDesc ? 'âœ…' : 'âŒ';

          row.innerHTML = `
            <td>${game.id}</td>
            <td><img src="${game.image || ''}" alt="å°é¢"></td>
            <td>${game.name}</td>
            <td>${platformName}</td>
            <td class="tag-cell">${game.tags?.join(', ') || ''}</td>
            <td>${game.badge || ''}</td>
            <td>${descMark}</td>
            <td class="url-cell">${game.url || ''}</td>
            <td>${game.customOrder || 0}</td>
            <td>
              <button class="edit-btn" onclick="showGameForm('${game.id}', this)">ç¼–è¾‘</button>
              <button class="delete-btn" onclick="deleteGame('${game.id}')">åˆ é™¤</button>
            </td>
          `;

          row.addEventListener('dragstart', (e) => {
            e.dataTransfer.setData('text/plain', game.id);
            row.style.opacity = '0.6';
          });

          row.addEventListener('dragend', () => {
            row.style.opacity = '1';
          });

          tbody.appendChild(row);
        });

        tbody.addEventListener('dragover', (e) => {
          e.preventDefault();
          e.dataTransfer.dropEffect = 'move';
        });

        tbody.addEventListener('drop', (e) => {
          e.preventDefault();
          const draggedId = e.dataTransfer.getData('text/plain');
          const targetRow = e.target.closest('tr');
          if (!targetRow || targetRow.dataset.id === draggedId) return;

          const draggedRow = document.querySelector(`[data-id="${draggedId}"]`);
          if (!draggedRow) return;

          tbody.insertBefore(draggedRow, targetRow);
          recalculateOrderForGroup(tbody, key);
        });

        groupDiv.appendChild(table);
        container.appendChild(groupDiv);
      });
    }

    function recalculateOrderForGroup(tbody, categoryId) {
      const rows = Array.from(tbody.querySelectorAll('tr'));
      rows.forEach((row, index) => {
        const id = row.dataset.id;
        const game = data.games.find(g => g.id === id);
        if (game) {
          game.customOrder = index + 1;
        }
      });
    }

    // é€šç”¨æ¸¸æˆè¡¨å•ï¼ˆæ–°å¢/ç¼–è¾‘ï¼‰
    function showGameForm(id = null, editBtn = null) {
      // ç§»é™¤æ‰€æœ‰æ—§è¡¨å•
      document.querySelectorAll('.edit-form-container').forEach(el => el.remove());

      const formContainer = document.createElement('div');
      formContainer.className = 'edit-form-container';

      const platforms = data.categories.map(c => 
        `<option value="${c.id}">${c.name}</option>`
      ).join('');

      let game = null;
      if (id) {
        game = data.games.find(g => g.id === id);
        if (!game) return;
      }

      // é»˜è®¤å€¼
      const name = game?.name || '';
      const image = game?.image || '';
      const category = game?.category || (data.categories[0]?.id || '');
      const tags = game?.tags?.join(', ') || '';
      const badge = game?.badge || '';
      const url = game?.url || '';
      const description = game?.description || '';
      const order = game?.customOrder || (getMaxOrder() + 1);

      formContainer.innerHTML = `
        <div class="form-left">
          <div class="form-field">
            <label>æ¸¸æˆåç§°</label>
            <input type="text" class="form-control" id="gameName" value="${name}" placeholder="è¾“å…¥æ¸¸æˆåç§°">
          </div>
          <div class="form-field">
            <label>å›¾ç‰‡ URL</label>
            <input type="text" class="form-control" id="gameImage" value="${image}" placeholder="å›¾ç‰‡é“¾æ¥">
          </div>
          <div class="form-field">
            <label>å¹³å°</label>
            <select class="form-control" id="gameCategory">
              ${platforms}
            </select>
          </div>
          <div class="form-field">
            <label>æ ‡ç­¾ï¼ˆé€—å·åˆ†éš”ï¼‰</label>
            <input type="text" class="form-control" id="gameTags" value="${tags}" placeholder="åŠ¨ä½œ, å†’é™©">
          </div>
          <div class="form-field">
            <label>è§’æ ‡æ ‡ç­¾</label>
            <input type="text" class="form-control" id="gameBadge" value="${badge}" placeholder="VR">
          </div>
          <div class="form-field">
            <label>æ¸¸æˆé“¾æ¥</label>
            <input type="text" class="form-control" id="gameUrl" value="${url}" placeholder="https://...">
          </div>
          <div class="form-field">
            <label>æ¸¸æˆä»‹ç»</label>
            <textarea class="form-control" id="gameDescription" rows="1" placeholder="è¯¦ç»†ä»‹ç»...">${description}</textarea>
          </div>
          <div class="form-field">
            <label>è‡ªå®šä¹‰æ’åº</label>
            <input type="number" class="form-control" id="gameOrder" value="${order}">
          </div>
        </div>
        <div class="form-right">
          <button class="floating-btn" onclick="${id ? `saveGame('${id}')` : 'addNewGame()'}">${id ? 'ä¿å­˜ä¿®æ”¹' : 'ä¿å­˜æ–°å¢'}</button>
          <button class="floating-btn copy" onclick="this.closest('.edit-form-container').remove()">å–æ¶ˆ</button>
        </div>
      `;

      // æ’å…¥ä½ç½®é€»è¾‘
      const gameGroups = document.getElementById('gameGroups');
      if (id && editBtn) {
        // ç¼–è¾‘æ¨¡å¼ï¼šæ’å…¥åœ¨å½“å‰è¡Œä¸‹æ–¹
        const row = editBtn.closest('tr');
        row.parentNode.insertBefore(formContainer, row.nextSibling);
      } else {
        // æ–°å¢æ¨¡å¼ï¼šæ’å…¥åœ¨æœ€åº•éƒ¨
        if (gameGroups.lastChild) {
          gameGroups.insertBefore(formContainer, gameGroups.lastChild.nextSibling);
        } else {
          gameGroups.appendChild(formContainer);
        }
        // è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨
        setTimeout(() => {
          formContainer.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }, 100);
      }

      // è®¾ç½®é€‰ä¸­å¹³å°
      document.getElementById('gameCategory').value = category;
    }

    function saveGame(id) {
      const name = document.getElementById('gameName').value.trim();
      const image = document.getElementById('gameImage').value.trim();
      const category = document.getElementById('gameCategory').value;
      const tags = document.getElementById('gameTags').value.split(',').map(t => t.trim()).filter(t => t);
      const badge = document.getElementById('gameBadge').value.trim();
      const url = document.getElementById('gameUrl').value.trim();
      const description = document.getElementById('gameDescription').value.trim();
      const order = parseInt(document.getElementById('gameOrder').value) || 0;

      if (!name) {
        alert('è¯·è¾“å…¥æ¸¸æˆåç§°');
        return;
      }

      const game = data.games.find(g => g.id === id);
      if (game) {
        game.name = name;
        game.image = image;
        game.category = category;
        game.tags = tags;
        game.badge = badge;
        game.url = url;
        game.description = description;
        game.customOrder = order;
        renderGames();
      }
    }

    function addNewGame() {
      const name = document.getElementById('gameName').value.trim();
      const image = document.getElementById('gameImage').value.trim();
      const category = document.getElementById('gameCategory').value;
      const tags = document.getElementById('gameTags').value.split(',').map(t => t.trim()).filter(t => t);
      const badge = document.getElementById('gameBadge').value.trim();
      const url = document.getElementById('gameUrl').value.trim();
      const description = document.getElementById('gameDescription').value.trim();
      const order = parseInt(document.getElementById('gameOrder').value) || (getMaxOrder() + 1);

      if (!name) {
        alert('è¯·è¾“å…¥æ¸¸æˆåç§°');
        return;
      }

      const newId = 'g_' + Date.now();
      data.games.push({
        id: newId,
        name: name,
        image: image,
        category: category,
        tags: tags,
        badge: badge,
        url: url,
        description: description,
        customOrder: order
      });

      renderGames();
      document.querySelectorAll('.edit-form-container').forEach(el => el.remove());
    }

    function deleteGame(id) {
      if (confirm('ç¡®å®šåˆ é™¤è¯¥æ¸¸æˆï¼Ÿ')) {
        data.games = data.games.filter(g => g.id !== id);
        renderGames();
      }
    }

    function exportJson() {
      const jsonStr = JSON.stringify(data, null, 2);
      const blob = new Blob([jsonStr], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'game.json';
      a.click();
      URL.revokeObjectURL(url);
    }

    function copyJsonData() {
      const jsonStr = JSON.stringify(data, null, 2);
      navigator.clipboard.writeText(jsonStr)
        .then(() => alert('JSON æ•°æ®å·²å¤åˆ¶åˆ°å‰ªè´´æ¿'))
        .catch(err => alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶'));
    }

    window.addEventListener('DOMContentLoaded', loadData);
  </script>

</body>
</html>
