<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>游戏库管理系统</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            min-height: 100vh;
            padding: 20px;
        }
        
        header {
            background-color: #2c3e50;
            color: white;
            padding: 15px 20px;
            text-align: center;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        header h1 {
            margin: 0;
            font-size: 28px;
            font-weight: 600;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        /* 公告栏 */
        .announcement {
            background-color: #fff;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .announcement-text {
            font-size: 16px;
            color: #333;
            font-weight: 500;
            flex: 1;
            text-align: center;
        }
        
        .edit-announcement {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s ease;
        }
        
        .edit-announcement:hover {
            background-color: #2980b9;
        }
        
        /* 拖拽排序控制区域 */
        .drag-sort-controls {
            background-color: #fff;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            text-align: center;
        }
        
        .drag-sort-controls h3 {
            margin-bottom: 10px;
            color: #333;
            font-size: 18px;
        }
        
        .drag-sort-controls p {
            color: #666;
            font-size: 14px;
            margin-bottom: 15px;
        }
        
        .drag-sort-controls button {
            background-color: #e74c3c;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s ease;
        }
        
        .drag-sort-controls button:hover {
            background-color: #c0392b;
        }
        
        /* 游戏管理面板 */
        .admin-panel {
            background-color: #fff;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .admin-panel h2 {
            margin-bottom: 20px;
            color: #333;
            font-size: 22px;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        .form-group label {
            font-size: 14px;
            font-weight: 600;
            color: #555;
            margin-bottom: 8px;
        }
        
        .form-group input,
        .form-group select {
            padding: 10px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            outline: none;
            transition: border-color 0.3s ease;
        }
        
        .form-group input:focus,
        .form-group select:focus {
            border-color: #3498db;
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .checkbox-group input {
            width: auto;
            margin: 0;
        }
        
        .checkbox-group label {
            margin: 0;
            font-weight: normal;
        }
        
        .form-actions {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }
        
        .btn-primary {
            background-color: #27ae60;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #229954;
        }
        
        .btn-secondary {
            background-color: #3498db;
            color: white;
        }
        
        .btn-secondary:hover {
            background-color: #2980b9;
        }
        
        .btn-warning {
            background-color: #f39c12;
            color: white;
        }
        
        .btn-warning:hover {
            background-color: #e67e22;
        }
        
        /* 状态提示 */
        #status {
            text-align: center;
            padding: 15px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 20px;
            font-size: 14px;
            color: #666;
        }
        
        /* 游戏列表 */
        .games-section {
            background-color: #fff;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        .games-section h2 {
            margin-bottom: 20px;
            color: #333;
            font-size: 22px;
        }
        
        .games-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 15px;
        }
        
        /* 游戏卡片 */
        .game-card {
            background-color: #fff;
            border: 2px dashed #ddd;
            border-radius: 8px;
            overflow: hidden;
            transition: all 0.3s ease;
            position: relative;
            padding: 10px;
            cursor: move;
        }
        
        .game-card:hover {
            border-color: #3498db;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        .game-card.dragging {
            opacity: 0.5;
            border-color: #3498db;
        }
        
        .game-card.drag-over {
            border-color: #27ae60;
            background-color: #f8f9fa;
        }
        
        .game-image-container {
            position: relative;
            height: 160px;
            overflow: hidden;
            background-color: #f5f5f5;
            border-radius: 4px;
            margin-bottom: 10px;
        }
        
        .game-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .top-left-badge {
            position: absolute;
            top: 8px;
            left: 8px;
            background-color: #e74c3c;
            color: white;
            font-size: 12px;
            font-weight: 600;
            padding: 4px 8px;
            border-radius: 4px;
            z-index: 10;
        }
        
        .new-release-badge {
            position: absolute;
            top: 8px;
            right: 8px;
            background-color: #e67e22;
            color: white;
            font-size: 12px;
            padding: 4px 8px;
            border-radius: 4px;
            z-index: 10;
        }
        
        .game-tag {
            position: absolute;
            bottom: 8px;
            right: 8px;
            background-color: rgba(52, 152, 219, 0.9);
            color: white;
            font-size: 11px;
            padding: 3px 8px;
            border-radius: 12px;
            z-index: 10;
        }
        
        .game-info {
            padding: 5px 0;
        }
        
        .game-title {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .game-format {
            font-size: 14px;
            color: #666;
            margin-bottom: 10px;
        }
        
        .card-actions {
            display: flex;
            gap: 10px;
        }
        
        .btn-edit {
            background-color: #f39c12;
            color: white;
            flex: 1;
            font-size: 13px;
            padding: 8px;
        }
        
        .btn-edit:hover {
            background-color: #e67e22;
        }
        
        .btn-delete {
            background-color: #e74c3c;
            color: white;
            flex: 1;
            font-size: 13px;
            padding: 8px;
        }
        
        .btn-delete:hover {
            background-color: #c0392b;
        }
        
        /* 编辑弹窗 */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .modal-header h3 {
            font-size: 20px;
            color: #333;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 24px;
            color: #666;
            cursor: pointer;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background-color 0.3s ease;
        }
        
        .close-modal:hover {
            background-color: #f5f5f5;
        }
        
        /* 导出按钮 */
        .export-section {
            text-align: center;
            margin: 30px 0;
        }
        
        .btn-export {
            background-color: #9b59b6;
            color: white;
            padding: 15px 30px;
            font-size: 16px;
        }
        
        .btn-export:hover {
            background-color: #8e44ad;
        }
        
        /* 返回按钮 */
        .back-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #2c3e50;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            z-index: 100;
        }
        
        .back-button:hover {
            background-color: #34495e;
            transform: scale(1.1);
        }
        
        /* 响应式设计 */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .form-actions {
                flex-direction: column;
            }
            
            .form-actions .btn {
                width: 100%;
            }
            
            .games-container {
                grid-template-columns: 1fr;
            }
            
            .modal-content {
                padding: 20px;
                width: 95%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>🎮 游戏库管理系统</h1>
        </header>
        
        <!-- 公告栏 -->
        <div class="announcement">
            <span id="announcementText" class="announcement-text">🎉 请按下单套餐游戏数量按需选择，游戏后期可10元一次更换哦~</span>
            <button class="edit-announcement" onclick="editAnnouncement()">✏️ 编辑公告</button>
        </div>
        
        <!-- 拖拽排序控制区域 -->
        <div class="drag-sort-controls">
            <h3>🎯 拖拽排序功能</h3>
            <p>💡 提示：在下方游戏列表中，直接拖拽卡片即可调整顺序。排序结果会自动保存。</p>
            <button onclick="clearDragSort()">🗑️ 清除拖拽排序</button>
        </div>
        
        <!-- 游戏管理面板 -->
        <div class="admin-panel">
            <h2>➕ 添加新游戏</h2>
            <div class="form-grid">
                <div class="form-group">
                    <label for="gameName">游戏名称 *</label>
                    <input type="text" id="gameName" placeholder="请输入游戏名称" required>
                </div>
                <div class="form-group">
                    <label for="gameImageUrl">图片链接 *</label>
                    <input type="url" id="gameImageUrl" placeholder="请输入图片URL" required>
                </div>
                <div class="form-group">
                    <label for="gameFormat">内容形式 *</label>
                    <select id="gameFormat" required>
                        <option value="仅数字版">仅数字版</option>
                        <option value="数字版&光盘">数字版&光盘</option>
                        <option value="仅光盘">仅光盘</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="gameTag">自定义标签（可选）</label>
                    <input type="text" id="gameTag" placeholder="如：必玩、打折、经典">
                </div>
                <div class="form-group">
                    <label for="gameLink">超链接（可选）</label>
                    <input type="url" id="gameLink" placeholder="https://www.example.com">
                </div>
            </div>
            
            <div class="form-grid" style="margin-top: 10px;">
                <div class="form-group checkbox-group">
                    <input type="checkbox" id="gameNewRelease">
                    <label for="gameNewRelease">标记为即将上新游戏</label>
                </div>
            </div>
            
            <div class="form-group" style="margin-top: 10px;">
                <label for="gameReleaseDate">发售日期（仅即将上新游戏需要）</label>
                <input type="date" id="gameReleaseDate">
            </div>
            
            <div class="form-actions">
                <button class="btn btn-primary" onclick="addGame()">➕ 添加游戏</button>
                <button class="btn btn-secondary" onclick="clearAddForm()">🔄 清空表单</button>
            </div>
        </div>
        
        <!-- 状态提示 -->
        <div id="status"></div>
        
        <!-- 游戏列表 -->
        <div class="games-section">
            <h2>🎮 游戏列表（共<span id="gameCount">0</span>个游戏）</h2>
            <div id="gamesContainer" class="games-container"></div>
        </div>
        
        <!-- 数据导出 -->
        <div class="export-section">
            <button class="btn btn-export" onclick="exportDataFunc()">💾 导出数据到 games.json</button>
        </div>
        
        <!-- 即将上新管理工具 -->
        <div class="export-section" style="margin-top: 15px;">
            <button class="btn" style="background-color: #e74c3c;" onclick="window.location.href='reset-new-releases.html'">🔄 重置所有"即将上新"标记</button>
        </div>
    </div>
    
    <!-- 编辑弹窗 -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>✏️ 编辑游戏</h3>
                <button class="close-modal" onclick="closeEditModal()">×</button>
            </div>
            
            <div class="form-grid">
                <div class="form-group">
                    <label for="editName">游戏名称 *</label>
                    <input type="text" id="editName" required>
                </div>
                <div class="form-group">
                    <label for="editImage">图片链接 *</label>
                    <input type="url" id="editImage" required>
                </div>
                <div class="form-group">
                    <label for="editFormat">内容形式 *</label>
                    <select id="editFormat" required>
                        <option value="仅数字版">仅数字版</option>
                        <option value="数字版&光盘">数字版&光盘</option>
                        <option value="仅光盘">仅光盘</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="editTag">自定义标签</label>
                    <input type="text" id="editTag" placeholder="如：必玩、打折">
                </div>
                <div class="form-group">
                    <label for="editLink">超链接</label>
                    <input type="url" id="editLink" placeholder="https://www.example.com">
                </div>
            </div>
            
            <div class="form-grid" style="margin-top: 10px;">
                    <div class="form-group checkbox-group">
                        <input type="checkbox" id="editNewRelease">
                        <label for="editNewRelease">标记为即将上新游戏</label>
                    </div>
                </div>
                
                <div class="form-group" style="margin-top: 10px;">
                    <label for="editReleaseDate">发售日期（仅即将上新游戏需要）</label>
                    <input type="date" id="editReleaseDate">
                </div>
            
            <div class="form-actions" style="margin-top: 20px;">
                <button class="btn btn-primary" onclick="saveEdit()">💾 保存修改</button>
                <button class="btn btn-warning" onclick="closeEditModal()">❌ 取消</button>
            </div>
        </div>
    </div>
    
    <!-- 返回按钮 -->
    <button class="back-button" onclick="window.location.href='index.html'">🏠</button>
    
    <script src="script.js"></script>
    
    <script>
        // 页面加载时执行
        document.addEventListener('DOMContentLoaded', async function() {
            // 强制设置为管理员模式
            isAdmin = true;
            
            // 加载数据
            const loadSuccess = await loadData();
            if (loadSuccess) {
                filterAndSort();
                setupDragSort();
                // 确保游戏列表被正确渲染
                renderGames(games);
                document.getElementById("gameCount").textContent = games.length;
            }
        });
        
        // 覆盖共用的filterAndSort函数，确保在管理页面渲染所有游戏
        function filterAndSort() {
            const query = document.getElementById("searchInput")?.value.trim().toLowerCase() || '';
            const sort = document.getElementById("sortSelect")?.value || 'default';

            let filtered = [...games];
            
            if (query) {
                filtered = filtered.filter(g => g.name.toLowerCase().includes(query));
            }

            if (sort === 'name-asc') {
                filtered.sort((a, b) => a.name.localeCompare(b.name));
            } else if (sort === 'name-desc') {
                filtered.sort((a, b) => b.name.localeCompare(a.name));
            } else if (sort === 'drag-sort') {
                // 应用保存的拖拽排序
                if (localStorage.getItem('dragSortOrder')) {
                    const dragSortOrder = JSON.parse(localStorage.getItem('dragSortOrder'));
                    filtered.sort((a, b) => {
                        const indexA = dragSortOrder.indexOf(a.id);
                        const indexB = dragSortOrder.indexOf(b.id);
                        if (indexA === -1 && indexB === -1) return 0;
                        if (indexA === -1) return 1;
                        if (indexB === -1) return -1;
                        return indexA - indexB;
                    });
                } else {
                    // 如果没有保存的排序，则使用默认排序
                    if (document.getElementById("sortSelect")) {
                        document.getElementById("sortSelect").value = "default";
                    }
                }
            }

            filteredGames = filtered;
            // 在管理页面直接渲染所有游戏，而不是使用loadMore
            renderGames(filtered);
        }
        
        // 编辑公告
        function editAnnouncement() {
            const current = document.getElementById("announcementText").innerText.trim();
            const newAnnounce = prompt("编辑公告内容：", current);
            if (newAnnounce !== null && newAnnounce.trim() !== '') {
                document.getElementById("announcementText").innerText = newAnnounce.trim();
            }
        }
        
        // 添加游戏
        function addGame() {
            const name = document.getElementById("gameName").value.trim();
            const image = document.getElementById("gameImageUrl").value.trim();
            const format = document.getElementById("gameFormat").value;
            const tag = document.getElementById("gameTag").value.trim();
            const link = document.getElementById("gameLink").value.trim();
            const newRelease = document.getElementById("gameNewRelease").checked;
            const releaseDate = document.getElementById("gameReleaseDate").value;

            if (!name || !image || !format) {
                alert("请填写所有必填字段！");
                return;
            }

            if (isDuplicate(name, games)) {
                if (!confirm(`⚠️ 检测到可能重复：“${name}”\n确定要继续添加吗？`)) return;
            }

            // 构建游戏对象
            const gameData = { id: generateId(), name, image, format, tag, link, newRelease };
            
            // 如果标记为即将上新并且有发售日期，则添加发售日期字段
            if (newRelease && releaseDate) {
                gameData.releaseDate = releaseDate;
            }
            
            games.push(gameData);
            
            // 直接调用admin页面的renderGames函数，确保新增游戏正确显示
            const container = document.getElementById("gamesContainer");
            if (container) {
                container.innerHTML = "";
                renderGames(games);
            }
            
            clearAddForm();
            document.getElementById("gameCount").textContent = games.length;
            
            // 保存数据到localStorage
            saveData();
        }
        
        // 保存数据到localStorage和games.json
        function saveData() {
            const announceText = document.getElementById("announcementText").innerText.trim();
            
            // 首先保存到localStorage
            localStorage.setItem('gamesData', JSON.stringify({
                announcement: announceText,
                games: games
            }));
            
            // 然后也保存到games.json文件，确保刷新页面后数据依然存在
            // 这里通过将数据下载为文件的方式提供保存选项
            const dataStr = JSON.stringify({
                announcement: announceText,
                games: games
            }, null, 2);
            
            // 提示用户保存更改到文件
            if (confirm('游戏数据已成功保存到浏览器本地存储。\n\n如果您想确保数据永久保存，请点击确定下载games.json文件并替换原文件。')) {
                const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
                const exportFileDefaultName = 'games.json';
                
                const linkElement = document.createElement('a');
                linkElement.setAttribute('href', dataUri);
                linkElement.setAttribute('download', exportFileDefaultName);
                linkElement.click();
            }
        }
        
        // 编辑
        function openEditModal(index) {
            editingIndex = index;
            const game = games[index];
            document.getElementById("editName").value = game.name;
            document.getElementById("editImage").value = game.image;
            document.getElementById("editFormat").value = game.format;
            document.getElementById("editTag").value = game.tag || '';
            document.getElementById("editLink").value = game.link || '';
            document.getElementById("editNewRelease").checked = game.newRelease || false;
            document.getElementById("editReleaseDate").value = game.releaseDate || '';
            document.getElementById("editModal").style.display = "flex";
        }
        
        function saveEdit() {
            const name = document.getElementById("editName").value.trim();
            const image = document.getElementById("editImage").value.trim();
            const format = document.getElementById("editFormat").value;
            const tag = document.getElementById("editTag").value.trim();
            const link = document.getElementById("editLink").value.trim();
            const newRelease = document.getElementById("editNewRelease").checked;
            const releaseDate = document.getElementById("editReleaseDate").value;

            if (!name || !image || !format) {
                alert("请填写所有必填字段！");
                return;
            }

            // 保留原有id
            const id = games[editingIndex].id;
            
            // 构建游戏对象
            const gameData = { id, name, image, format, tag, link, newRelease };
            
            // 如果标记为即将上新并且有发售日期，则添加发售日期字段
            if (newRelease && releaseDate) {
                gameData.releaseDate = releaseDate;
            } else {
                // 如果取消标记为即将上新，删除发售日期字段
                delete gameData.releaseDate;
            }
            
            games[editingIndex] = gameData;
            filterAndSort();
            closeEditModal();
        }
        
        function closeEditModal() {
            document.getElementById("editModal").style.display = "none";
            editingIndex = null;
        }
        
        function deleteGame(index) {
            if (confirm(`确定删除《${games[index].name}》？`)) {
                games.splice(index, 1);
                filterAndSort();
                document.getElementById("gameCount").textContent = games.length;
                saveData(); // 确保删除后立即保存数据
            }
        }
        
        function clearAddForm() {
            document.getElementById("gameName").value = "";
            document.getElementById("gameImageUrl").value = "";
            document.getElementById("gameFormat").value = "仅数字版";
            document.getElementById("gameTag").value = "";
            document.getElementById("gameLink").value = "";
            document.getElementById("gameNewRelease").checked = false;
        }
        
        // 覆盖共用的renderGames函数，只用于管理页面
        function renderGames(gamesToRender) {
            const container = document.getElementById("gamesContainer");
            if (!container) return;
            
            container.innerHTML = "";

            gamesToRender.forEach((game, index) => {
                const card = document.createElement("div");
                card.className = "game-card";
                card.draggable = true;
                card.dataset.id = game.id;
                
                // 添加拖拽相关的类名
                card.addEventListener('dragstart', function() {
                    this.classList.add('dragging');
                });
                
                card.addEventListener('dragend', function() {
                    this.classList.remove('dragging');
                    // 移除所有drag-over类
                    document.querySelectorAll('.game-card.drag-over').forEach(el => {
                        el.classList.remove('drag-over');
                    });
                });
                
                card.addEventListener('dragover', function(e) {
                    e.preventDefault();
                    // 移除其他卡片的drag-over类
                    document.querySelectorAll('.game-card.drag-over').forEach(el => {
                        el.classList.remove('drag-over');
                    });
                    // 为当前卡片添加drag-over类
                    this.classList.add('drag-over');
                });
                
                card.addEventListener('dragleave', function() {
                    this.classList.remove('drag-over');
                });

                let badgesHtml = '';
                if (game.newRelease) badgesHtml += '<div class="new-release-badge">即将上新</div>';
                const tagHtml = game.tag ? `<div class="game-tag">${game.tag}</div>` : '';

                // 为游戏名称添加'上新'标签
                const newReleaseTag = game.newRelease ? '<span style="display: inline-block; margin-left: 8px; padding: 2px 6px; background-color: #e74c3c; color: white; border-radius: 4px; font-size: 12px; font-weight: normal;">上新</span>' : '';
                
                card.innerHTML = `
                    <div class="game-image-container">
                        <img src="${game.image}" alt="${game.name}" class="game-image" onerror="this.src='data:image/svg+xml;charset=UTF-8,%3csvg xmlns%3d%22http%3a%2f%2fwww.w3.org%2f2000%2fsvg%22 width%3d%22140%22 height%3d%22100%22 viewBox%3d%220 0 140 100%22 fill%3d%22none%22%3e%3crect width%3d%22140%22 height%3d%22100%22 fill%3d%22%23f0f0f0%22%2f%3e%3ctext x%3d%2270%22 y%3d%2250%22 dominant-baseline%3d%22middle%22 text-anchor%3d%22middle%22 font-family%3d%22Arial%22 font-size%3d%2210%22 fill%3d%22%23666%22%3e${encodeURIComponent(game.name)}%3c%2ftext%3e%3c%2fsvg%3e'">
                        ${badgesHtml}
                        ${tagHtml}
                    </div>
                    <div class="game-info">
                        <h3 class="game-title">${game.name}${newReleaseTag}</h3>
                        <p class="game-format">${game.format}</p>
                    ${game.releaseDate ? `<p style="color: #e67e22; font-size: 12px; margin-top: 4px;">发售日期：${game.releaseDate}</p>` : ''}
                    <div class="card-actions">
                            <button class="btn btn-edit" onclick="openEditModal(${index})">编辑</button>
                            <button class="btn btn-delete" onclick="deleteGame(${index})">删除</button>
                        </div>
                    </div>
                `;

                container.appendChild(card);
            });
        }
    </script>
</body>
</html>